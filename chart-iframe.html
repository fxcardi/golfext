<!DOCTYPE html>

<html>
  <head>
<style>
#luzmo-viz-item {
    display: none;  // Hide the chart initially
}
</style>
    <script
      defer
      src="https://cdn.luzmo.com/js/luzmo-embed/5.1.3-beta.3/luzmo-embed.min.js"
      charset="utf-8"
    ></script>
  </head>
  <body style="background-color: white;">
    <!-- Tooltip Card Container -->
<div id="golferTooltip"  class="tooltip-card">
    <div class="tooltip-content">
        <div class="tooltip-row">
            <span class="label">Name:</span>
            <span id="golferName" class="value">-</span>
        </div>
        <div class="tooltip-row">
            <span class="label">Age:</span>
            <div class="container" style="height: 250px;">
      <luzmo-viz-item
        id = "golferChart4"
        apiHost = "https://api.luzmo.com"
        appServer = "https://app.luzmo.com"
        authKey = "87a16452-9b44-478c-bc95-a182832262f9"
        authToken = "6K4FUlGErvkVPscDlEfUpk4YBcNQN2CzufuH8bPbEzXJTZdOcQr1d4Yf9tN7rRl6OhSBHKSPtnWiKtWCJ97x9Zx6Fug2lYtsPMawJ98GeA0IAFfKRRvCm5CcQBedUcmmTUj6yrYWgiuYyzVOrY4ahi"
        class="one-number"
        type="one-number"
        title= "{}"
        options='{
          "theme": "seasonal",
          "mode": "100",
            "categories": {
              "colored": false
            }
            }'
        slots='[
            {
              "name": "measure",
              "content": [
                {
                  "column": "19d353af-ae3c-4926-b95c-d89b87ee1d3e",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "AGE"
                  },
                  "type": "numeric",
                  "format": ".0f",
                  "aggregationFunc": "min"
                }
              ]'
      >
      </luzmo-viz-item> 
        </div>
        <div class="tooltip-row">
            <span class="label">Total Earnings:</span>
            <span id="golferEarnings" class="value">$0</span>
        </div>
    </div>
</div>

          <luzmo-viz-item
        id = "golferChart2"
        apiHost = "https://api.luzmo.com"
        appServer = "https://app.luzmo.com"
        authKey = "87a16452-9b44-478c-bc95-a182832262f9"
        authToken = "6K4FUlGErvkVPscDlEfUpk4YBcNQN2CzufuH8bPbEzXJTZdOcQr1d4Yf9tN7rRl6OhSBHKSPtnWiKtWCJ97x9Zx6Fug2lYtsPMawJ98GeA0IAFfKRRvCm5CcQBedUcmmTUj6yrYWgiuYyzVOrY4ahi"
        class="bar-chart"
        type="bar-chart"
        title= "{}"
        options='{
          "theme": "seasonal",
          "mode": "100",
            "categories": {
              "colored": false
            },
            "axis": {
              "x": {
                "ticksMode": "ticks",
                "scale": "linear"
              },
              "y": {
                "ticksMode": "ticks"
              }
            },
            "hidemodeOption": true,
            "bars": {
              "label": "absolute"
            },
            "display": {
              "title": false,
              "legend": false,
              "modeOption": false
            },
            "legend": {
              "position": "topRight"
            }
            }'
        slots=' [
            {
              "name": "y-axis",
              "content": [
                {
                  "column": "24ce15dd-3807-490a-983f-273bd57fdc61",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Year (Yr)"
                  },
                  "type": "datetime",
                  "format": "%d-%m-%Y",
                  "lowestLevel": 9,
                  "level": 1
                }
              ]
            },
            {
              "name": "measure",
              "content": [
                {
                  "column": "a0808f8d-b075-4035-8956-c475266958b6",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Earnings"
                  },
                 "type": "numeric",
                  "subtype": "currency",
                  "format": ",.4as",
                  "currency": "$"
              }
            ]
          }
        ]'
      >
      </luzmo-viz-item> 
    </div>
     <div class="container" style="height: 150px;">
      <luzmo-viz-item
        id = "golferChart"
        apiHost = "https://api.luzmo.com"
        appServer = "https://app.luzmo.com"
        authKey = "87a16452-9b44-478c-bc95-a182832262f9"
        authToken = "6K4FUlGErvkVPscDlEfUpk4YBcNQN2CzufuH8bPbEzXJTZdOcQr1d4Yf9tN7rRl6OhSBHKSPtnWiKtWCJ97x9Zx6Fug2lYtsPMawJ98GeA0IAFfKRRvCm5CcQBedUcmmTUj6yrYWgiuYyzVOrY4ahi"
        class="line-chart"
        type="line-chart"
        title= '{
        "en": "Rank per year"
        }'
        options='{
          "theme": "seasonal",
          "bars": {
            "roundedCorners": 7
          },
          "display": {
              "title": true
            },
          "markers": {
              "enabled": true,
              "size": 5
            }
        }'
       slots='[
            {
              "name": "measure",
              "content": [
                {
                  "column": "b7023337-e553-4302-b7c6-e069d589e4bd",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "RK"
                  },
                  "type": "numeric",
                  "format": ".0f"
                }
              ]
            },
            {
              "name": "x-axis",
              "content": [
                {
                  "column": "24ce15dd-3807-490a-983f-273bd57fdc61",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Year (Yr)"
                  },
                  "type": "datetime",
                  "format": "%d-%m-%Y",
                  "lowestLevel": 9,
                  "level": 1
              }
            ]
          }
        ]'
      >
      </luzmo-viz-item> 
    </div>
<div style="font-size: 13px;height: 40px;line-height: 40px;display: block;float: right;    font-family: 'Exo';">
<select id="yearSelect">
    <option value="All" selected>All</option>
    <option value="2024">2024</option>
    <option value="2023">2023</option>
    <option value="2022">2022</option>
    <option value="2021">2021</option>
    <option value="2020">2020</option>
    <option value="2019">2019</option>
    <option value="2018">2018</option>
    <option value="2017">2017</option>
    <option value="2016">2016</option>
    <option value="2015">2015</option>
    <option value="2014">2014</option>
    <option value="2013">2013</option>
</select>
</div>
         <div class="container" style="height: 300px;">
      <luzmo-viz-item
        id = "golferChart3"
        apiHost = "https://api.luzmo.com"
        appServer = "https://app.luzmo.com"
        authKey = "87a16452-9b44-478c-bc95-a182832262f9"
        authToken = "6K4FUlGErvkVPscDlEfUpk4YBcNQN2CzufuH8bPbEzXJTZdOcQr1d4Yf9tN7rRl6OhSBHKSPtnWiKtWCJ97x9Zx6Fug2lYtsPMawJ98GeA0IAFfKRRvCm5CcQBedUcmmTUj6yrYWgiuYyzVOrY4ahi"
        class="funnel"
        type="funnel"
        title= '{
        "en": "Rank per year"
        }'
        options='{
          "theme": "seasonal",
            "display": {
              "title": false,
              "legend": false,
              "categoryLabels": true,
              "values": true
            },
            "mode": "dynamicWidth",
          "markers": {
              "enabled": true,
              "size": 5
            },
          "funnel": {
              "rectangle": false,
              "absValue": true,
              "perc": "ofMax"
            },
          "legend": {
              "position": "right"
            }
        }'
       slots='[
            {
              "name": "measure",
              "content": [
                {
                  "column": "dc9e5214-4c44-4254-9033-ef0ac7fa68d1",
                  "set": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540",
                  "label": {
                    "en": "Value"
                  },
                  "type": "numeric",
                  "format": ".0f"
                }
              ]
            },
            {
              "name": "category",
              "content": [
                {
                  "column": "7c874d02-f212-42a7-abad-21a588053d5c",
                  "set": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540",
                  "label": {
                    "en": "Category"
                  },
                  "type": "hierarchy",
                  "lowestLevel": 0,
                  "level": 1
                }
              ]
            }
          ]'
      >
      </luzmo-viz-item> 
    </div>
    <script>
        // Function to parse query parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

document.addEventListener("DOMContentLoaded", function() {
    const golferName = getQueryParam('golferName');
        const yearSelect = document.getElementById('yearSelect');
    const tooltip = document.getElementById('golferTooltip');
    const name = new URLSearchParams(window.location.search).get('golferName');
    document.getElementById('golferName').textContent = name || 'Unknown';


    console.log("Golfer name:", golferName);


setTimeout(() => {
      golferChart.filters = [{
        "condition": "or",
        "filters": [{
            "expression": "? in ?",
            "parameters": [{
                "column_id": "fd423f32-2f08-4a55-9b09-479d15df30aa",
                "dataset_id": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                "level": 1
            }, [golferName]]
        }]}];
golferChart2.filters = [{
        "condition": "or",
        "filters": [{
            "expression": "? in ?",
            "parameters": [{
                "column_id": "fd423f32-2f08-4a55-9b09-479d15df30aa",
                "dataset_id": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                "level": 1
            }, [golferName]]
        }]}];

  golferChart3.filters = [{
        "condition": "or",
        "filters": [{
            "expression": "? in ?",
            "parameters": [{
                "column_id": "6b6cff84-3bf3-496e-95c5-da73c4798b02",
                "dataset_id": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540",
                "level": 1
            }, [golferName]]
        }]
      }];
        golferChart4.filters = [{
        "condition": "or",
        "filters": [{
            "expression": "? in ?",
            "parameters": [{
                "column_id": "6b6cff84-3bf3-496e-95c5-da73c4798b02",
                "dataset_id": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540",
                "level": 1
            }, [golferName]]
        }]
      }];       
        }, 800);

yearSelect.addEventListener('change', function() {
        const selectedYear = this.value;
        console.log("Selected Year:", selectedYear);
        if(selectedYear!="All")
        {
        updateChartForYear(golferChart3, selectedYear);
         }
         else
         {
          golferChart3.filters = [{
        "condition": "or",
        "filters": [{
            "expression": "? in ?",
            "parameters": [{
                "column_id": "6b6cff84-3bf3-496e-95c5-da73c4798b02",
                "dataset_id": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540",
                "level": 1
            }, [golferName]]
        }]
      }]; 
         }
    });

function updateChartForYear(chart, year) {
      const startDate = new Date(year, 0, 1); // January 1 of selected year
    const endDate = new Date(year, 11, 31, 23, 59, 59, 999); // December 31 of selected year

    // Convert dates to ISO string and adjust for correct timezone if necessary
    const startDateStr = startDate.toISOString();
    const endDateStr = endDate.toISOString();

    // Assuming you have a way to update the chart data, you might need to fetch new data or adjust the chart's settings
    golferChart3.filters = [{
        "condition": "and",
        "filters": [{
            "expression": "? < ?",
                  "parameters": [
                    {
                      "column_id": "2d68abe3-b72a-49ae-9bf0-4b5afabcb03b",
                      "dataset_id": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540"
            },  [endDateStr]]
        },
        {
            "expression": "? > ?",
                  "parameters": [
                    {
                      "column_id": "2d68abe3-b72a-49ae-9bf0-4b5afabcb03b",
                      "dataset_id": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540"
            }, [startDateStr]]
        },
        {
            "expression": "? in ?",
            "parameters": [{
                "column_id": "6b6cff84-3bf3-496e-95c5-da73c4798b02",
                "dataset_id": "f3ca42c3-d26b-4b24-b2b5-89f0145bb540",
                "level": 1
            }, [golferName]]
        }]
    }];
}

});

    </script>
</body>
</html>

  </body>

</html>

