<!DOCTYPE html>

<html>
  <head>
<style>
#luzmo-viz-item {
    display: none;  // Hide the chart initially
}
</style>
    <script
      defer
      src="https://cdn.luzmo.com/js/luzmo-embed/5.1.3-beta.3/luzmo-embed.min.js"
      charset="utf-8"
    ></script>
  </head>
  <body>
    <script>
        // Function to parse query parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }


document.addEventListener("DOMContentLoaded", function() {
    const golferName = getQueryParam('golferName');
    updateChart('golferChart', golferName);
    updateChart('golferChart1', golferName); // Ensure this is called as well
    updateChart('golferChart2', golferName); // Ensure this is called as well

});

function updateChart(chartId, golferName) {
    const chart = document.getElementById(chartId);
    if (golferName && chart) {
        console.log("Applying filters to chart:", chartId);

        chart.filters = JSON.stringify([{
            "condition": "or",
            "filters": [{
                "expression": "? in ?",
                "parameters": [{
                        "column_id": "fd423f32-2f08-4a55-9b09-479d15df30aa",
                        "dataset_id": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                        "level": 1
                    },
                    [golferName]
                ]
            }]
        }]);
        setTimeout(() => {
            if (chart.isConnected && typeof chart.update === 'function') {
                chart.update();
                chart.style.display = 'block'; // Show the chart after updating
            } else {
                console.error("Component not ready or update method unavailable for:", chartId);
            }
        }, 800); // Delay to ensure settings have taken effect
    } else {
        console.error("Golfer name not provided or chart element not found:", chartId);
    }
}
    </script>

    </div>
        <div class="container" style="height: 100px;">
      <luzmo-viz-item
        id = "golferChart"
        apiHost = "https://api.luzmo.com"
        appServer = "https://app.luzmo.com"
        authKey = "c312dabb-fc0c-4ab0-95cf-2d5801eb404c"
        authToken = "wwIsAVAbI8Y7UbejK1STbHwSJYwYBm3En4eBGOIn82aRG2amYhnH0W3pLHIt0oAhOTwhbfkpbYAwxdADj1PSq0hxdv4kQfZbSdSVblbSu36GEx8lKYQp3CLi1iomZSiVyUCOasM0MGMbRGFdxJfUFz"
        class="line-chart"
        type="line-chart"
        title= '{
              "en": "Rank per year"
            }'
        options='{
          "theme": "royale",
          "bars": {
            "roundedCorners": 7
          },
          "display": {
              "title": true
            },
          "markers": {
              "enabled": true,
              "size": 5
            }
        }'
       slots='[
            {
              "name": "measure",
              "content": [
                {
                  "column": "b7023337-e553-4302-b7c6-e069d589e4bd",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "RK"
                  },
                  "type": "numeric",
                  "format": ".0f"
                }
              ]
            },
            {
              "name": "x-axis",
              "content": [
                {
                  "column": "24ce15dd-3807-490a-983f-273bd57fdc61",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Year (Yr)"
                  },
                  "type": "datetime",
                  "format": "%d-%m-%Y",
                  "lowestLevel": 9,
                  "level": 1
              }
            ]
          }
        ]'
      >
      </luzmo-viz-item> 
    </div>
    <div class="container" style="height: 200px;">
          <luzmo-viz-item
        id = "golferChart2"
        apiHost = "https://api.luzmo.com"
        appServer = "https://app.luzmo.com"
        authKey = "c312dabb-fc0c-4ab0-95cf-2d5801eb404c"
        authToken = "wwIsAVAbI8Y7UbejK1STbHwSJYwYBm3En4eBGOIn82aRG2amYhnH0W3pLHIt0oAhOTwhbfkpbYAwxdADj1PSq0hxdv4kQfZbSdSVblbSu36GEx8lKYQp3CLi1iomZSiVyUCOasM0MGMbRGFdxJfUFz"
        class="bar-chart"
        type="bar-chart"
        title= '{
              "en": "% of cut per year"
            }'
        options='{
          "theme": "royale",
          "bars": {
            "roundedCorners": 7
          },
          "display": {
              "title": true,
              "legend": true
            },
          "bars": {
              "label": "absolute"
            }

        }'
        slots=' [
            {
              "name": "y-axis",
              "content": [
                {
                  "column": "24ce15dd-3807-490a-983f-273bd57fdc61",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Year (Yr)"
                  },
                  "type": "datetime",
                  "format": "%d-%m-%Y",
                  "lowestLevel": 9,
                  "level": 1
                }
              ]
            },
            {
              "name": "measure",
              "content": [
                {
                  "column": "a3273cb3-9f78-4e7c-9650-9bb1319d4225",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "% cut"
                  },
                  "type": "numeric",
                  "format": ",.2a%"
              }
            ]
          }
        ]'
      >
      </luzmo-viz-item> 
    </div>
        <div class="container" style="height: 100px;">
      <luzmo-viz-item
       id = "golferChart1"
        apiHost = "https://api.luzmo.com"
        appServer = "https://app.luzmo.com"
        authKey = "c312dabb-fc0c-4ab0-95cf-2d5801eb404c"
        authToken = "wwIsAVAbI8Y7UbejK1STbHwSJYwYBm3En4eBGOIn82aRG2amYhnH0W3pLHIt0oAhOTwhbfkpbYAwxdADj1PSq0hxdv4kQfZbSdSVblbSu36GEx8lKYQp3CLi1iomZSiVyUCOasM0MGMbRGFdxJfUFz"
        class="bar-chart"
        type="bar-chart"
        title= '{
              "en": "Earnings per year"
            }'
        options='{
          "theme": "royale",
          "bars": {
            "roundedCorners": 7
          },
          "display": {
              "title": true
            },
          "markers": {
              "enabled": true,
              "size": 5
            },
            "bars": {
              "label": "absolute"
            }
          }'
       slots='[
            {
              "name": "y-axis",
              "content": []
            },
            {
              "name": "measure",
              "content": [
                {
                  "column": "a0808f8d-b075-4035-8956-c475266958b6",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Earnings in dollars"
                  },
                  "type": "numeric",
                  "format": ",.2af",
                  "currency": "$"
                }
              ]
            },
            {
              "name": "legend",
              "content": [
                {
                  "column": "24ce15dd-3807-490a-983f-273bd57fdc61",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Year (Yr)"
                  },
                  "type": "datetime",
                  "format": "%d-%m-%Y",
                  "lowestLevel": 9,
                  "level": 1
                }
            ]
          }
        ]'
      >
      </luzmo-viz-item> 
    </div>
</body>
</html>

  </body>

</html>

