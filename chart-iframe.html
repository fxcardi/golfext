<!DOCTYPE html>

<html>
  <head>
    <script
      defer
      src="https://cdn.luzmo.com/js/luzmo-embed/5.1.3-beta.3/luzmo-embed.min.js"
      charset="utf-8"
    ></script>
  </head>
  <body>
    <div class="container" style="height: 100px;">
      <luzmo-viz-item
        class="line-chart"
        type="line-chart"
        title= {}
        options='{
          "theme": "royale",
          "bars": {
            "roundedCorners": 7
          },
          "display": {
              "title": false
            },
          "markers": {
              "enabled": true,
              "size": 5
            },
        }'
       slots='[
            {
              "name": "measure",
              "content": [
                {
                  "column": "b7023337-e553-4302-b7c6-e069d589e4bd",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "RK"
                  },
                  "type": "numeric",
                  "format": ".0f"
                }
              ]
            },
            {
              "name": "x-axis",
              "content": [
                {
                  "column": "24ce15dd-3807-490a-983f-273bd57fdc61",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Year (Yr)"
                  },
                  "type": "datetime",
                  "format": "%d-%m-%Y",
                  "lowestLevel": 9,
                  "level": 1
              }
            ]
          }
        ]'
      >
      </luzmo-viz-item> 
      <div class="container" style="height: 100px;">
      <luzmo-viz-item
        class="bar-chart"
        type="bar-chart"
        options='{
            "mode": "100",
            "categories": {
              "colored": false
            },
            "grid": {
              "x": {
                "enabled": false
              },
              "y": {
                "enabled": false
              }
            },
            "axislabels": {
              "x": {
                "enabled": false,
                "position": "center"
              },
              "y": {
                "enabled": false,
                "position": "middle"
              }
            },
            "axis": {
              "x": {
                "ticksMode": "ticks",
                "scale": "linear"
              },
              "y": {
                "ticksMode": "ticks"
              }
            },
            "hidemodeOption": true,
            "bars": {
              "label": "absolute"
            }
          }'
       slots='[
            {
              "name": "y-axis",
              "content": []
            },
            {
              "name": "measure",
              "content": [
                {
                  "column": "a0808f8d-b075-4035-8956-c475266958b6",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Earnings in dollars"
                  },
                  "type": "numeric",
                  "subtype": "currency",
                  "format": ",.2af",
                  "currency": "$"
                }
              ]
            },
            {
              "name": "legend",
              "content": [
                {
                  "column": "24ce15dd-3807-490a-983f-273bd57fdc61",
                  "set": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                  "label": {
                    "en": "Year (Yr)"
                  },
                  "type": "datetime",
                  "subtype": null,
                  "format": "%d-%m-%Y",
                  "lowestLevel": 9,
                  "level": 1
                }
            ]
          }
        ]'
      >
      </luzmo-viz-item> 
    </div>

    <script>
      // add apihost, appServer, authKey and authToken to all luzmo-viz-item
      const luzmoVizItems = document.querySelectorAll('luzmo-viz-item');
      luzmoVizItems.forEach((item) => {
        item.apiHost = 'https://api.luzmo.com';
        item.appServer = 'https://app.luzmo.com';
        item.authKey = 'c312dabb-fc0c-4ab0-95cf-2d5801eb404c';
        item.authToken = 'wwIsAVAbI8Y7UbejK1STbHwSJYwYBm3En4eBGOIn82aRG2amYhnH0W3pLHIt0oAhOTwhbfkpbYAwxdADj1PSq0hxdv4kQfZbSdSVblbSu36GEx8lKYQp3CLi1iomZSiVyUCOasM0MGMbRGFdxJfUFz'
      });
    </script>
    <script>
        // Function to parse query parameters
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }


        // Wait until the DOM content is fully loaded
        document.addEventListener("DOMContentLoaded", function() {
            const golferName = getQueryParam('golferName');  // Get the golfer name from URL parameters
            const golferChart = document.getElementById('golferChart');
            const golferChart1 = document.getElementById('golferChart1');
        console.log("Golfer name", golferName);
        console.log("Golfer chart", golferChart);

            if (golferName && golferChart) {
                      console.log("Golfer name and chart element found.");

                golferChart.filters = JSON.stringify([
                    {
                        "condition": "or",
                        "filters": [
                            {
                                "expression": "? in ?",
                                "parameters": [
                                    {
                                        "column_id": "fd423f32-2f08-4a55-9b09-479d15df30aa",
                                        "dataset_id": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                                        "level": 1
                                    },
                                    [golferName]
                                ]
                            }
                        ]
                    }
                ]);
                 golferChart1.filters = JSON.stringify([
                    {
                        "condition": "or",
                        "filters": [
                            {
                                "expression": "? in ?",
                                "parameters": [
                                    {
                                        "column_id": "fd423f32-2f08-4a55-9b09-479d15df30aa",
                                        "dataset_id": "1086ce9e-6a9e-46f1-8add-67a423d748f6",
                                        "level": 1
                                    },
                                    [golferName]
                                ]
                            }
                        ]
                    }
                ]);

                // Update the chart after setting filters
        setTimeout(() => {
           if (golferChart && typeof golferChart.update === 'function') {
    golferChart.update(); // Assuming 'update' is the correct method
    golferChart1.update(); // Assuming 'update' is the correct method
} else if (golferChart && typeof golferChart.refresh === 'function') {
    golferChart.refresh(); // If 'refresh' is indeed the method
    golferChart1.refresh(); // If 'refresh' is indeed the method

} else {
    console.error("No valid update/refresh method found for golferChart.");
}
        }, 800); // Delay to ensure settings have taken effect
    } else {
        console.error("Golfer name not provided.");
    }

        });
    </script>
</body>
</html>

  </body>

</html>

